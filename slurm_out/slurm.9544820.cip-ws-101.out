An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/scratch/f/F.Conoscenti/Thesis_QSL/ViT_Heisenberg/ground_state.py", line 71, in <module>
    params = vit_module.init(subkey, spin_configs)
  File "/scratch/f/F.Conoscenti/Thesis_QSL/ViT_Heisenberg/ViT_model.py", line 308, in __call__
    z_plus = vit(spins)
  File "/scratch/f/F.Conoscenti/Thesis_QSL/ViT_Heisenberg/ViT_model.py", line 272, in __call__
    x = Embed(d_model=self.d_model, patch_size=self.patch_size)(x)
  File "/scratch/f/F.Conoscenti/Thesis_QSL/ViT_Heisenberg/ViT_model.py", line 38, in __call__
    x = extract_patches2d(x, self.patch_size)
  File "/scratch/f/F.Conoscenti/Thesis_QSL/ViT_Heisenberg/ViT_model.py", line 18, in extract_patches2d
    x = x.reshape(batch, n_patches, patch_size, n_patches, patch_size)
  File "/scratch/f/F.Conoscenti/netket_venv/lib64/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 149, in _reshape
    newshape = _compute_newshape(a, args[0] if len(args) == 1 else args)
  File "/scratch/f/F.Conoscenti/netket_venv/lib64/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 137, in _compute_newshape
    raise TypeError(f"cannot reshape array of shape {np.shape(a)} (size {np.size(a)}) "
TypeError: cannot reshape array of shape (10, 16) (size 160) into shape (10, 0, 8, 0, 8) (size 0)
[CpuDevice(id=0)]
[CpuDevice(id=0)]
srun: error: cip-ws-101: task 0: Exited with exit code 1
srun: Terminating StepId=9544820.0
