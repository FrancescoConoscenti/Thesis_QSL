Rank=0: Total number of GPUs: 1, devices: [CpuDevice(id=0)]
Rank=0: Local number of GPUs: 1, devices: [CpuDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/scratch/f/F.Conoscenti/Thesis_QSL/HFDS_Heisenberg/run_spin.py", line 185, in <module>
    vmc.run(n_iter=save_every, out=log)
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/driver/abstract_variational_driver.py", line 345, in run
    for step in self.iter(n_iter, step_size):
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/driver/abstract_variational_driver.py", line 230, in iter
    self._dp = self._forward_and_backward()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/utils/timing.py", line 292, in timed_function
    result = fun(*args, **kwargs)  # type: ignore[misc]
             ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/experimental/driver/vmc_sr.py", line 366, in _forward_and_backward
    self._dp, self._old_updates, self.info = compute_sr_update_fun(
                                             ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/utils/timing.py", line 292, in timed_function
    result = fun(*args, **kwargs)  # type: ignore[misc]
             ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/_src/ngd/sr_srt_common.py", line 148, in _sr_srt_common
    return unravel_params_fn(updates), old_updates, info
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/jax/_src/flatten_util.py", line 52, in unravel_pytree
    return tree_unflatten(treedef, unravel_list(flat))
                                   ^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/jax/_src/flatten_util.py", line 77, in _unravel_list_single_dtype
    return [chunk.reshape(shape) for chunk, shape in zip(chunks, shapes)]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/jax/_src/flatten_util.py", line 77, in <listcomp>
    return [chunk.reshape(shape) for chunk, shape in zip(chunks, shapes)]
            ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 1066, in meth
    return getattr(self.aval, name).fun(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 309, in _reshape
    newshape = _compute_newshape(self, args[0] if len(args) == 1 else args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 470, in _compute_newshape
    raise TypeError(f"cannot reshape array of shape {arr.shape} (size {arr.size}) "
TypeError: cannot reshape array of shape (661,) (size 661) into shape (2, 17) (size 34)
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
srun: error: th-cl-rome09n2: task 0: Exited with exit code 1
srun: Terminating StepId=10929851.0
