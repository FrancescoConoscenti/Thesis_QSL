Rank=0: Total number of GPUs: 1, devices: [CpuDevice(id=0)]
Rank=0: Local number of GPUs: 1, devices: [CpuDevice(id=0)]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/scratch/f/F.Conoscenti/Thesis_QSL/HFDS_Heisenberg/run_spin_3.py", line 164, in <module>
    vstate = nk.vqs.MCState(
             ^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/vqs/mc/mc_state/state.py", line 279, in __init__
    self.init(seed, dtype=sampler.dtype)
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/vqs/mc/mc_state/state.py", line 328, in init
    variables = jax.jit(self._init_fun, out_shardings=par_sharding)(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/vqs/mc/mc_state/state.py", line 249, in <lambda>
    lambda model, *args, **kwargs: model.init(*args, **kwargs), model
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/Thesis_QSL/HFDS_Heisenberg/HFDS_model_spin.py", line 121, in __call__
    log_det, log_sign = jax.vmap(self.calc_psi)(jnp.stack(x_sym))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/Thesis_QSL/HFDS_Heisenberg/HFDS_model_spin.py", line 65, in calc_psi
    orbitals = self.orbitals(x)
               ^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/Thesis_QSL/HFDS_Heisenberg/HFDS_model_spin.py", line 262, in __call__
    orbitals_selected.reshape(-1,self.n_elecs,x.shape[1])
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 1066, in meth
    return getattr(self.aval, name).fun(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 309, in _reshape
    newshape = _compute_newshape(self, args[0] if len(args) == 1 else args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 460, in _compute_newshape
    raise TypeError(f"cannot reshape array of shape {arr.shape} (size {arr.size}) "
TypeError: cannot reshape array of shape (16, 20) (size 320) into shape (-1, 16, 16) because the product of specified axis sizes (256) does not evenly divide 320
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
srun: error: met-cl-lx024: task 0: Exited with exit code 1
srun: Terminating StepId=10905509.0
