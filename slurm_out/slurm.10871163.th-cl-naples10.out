--- Loading pre-trained DMRG state from DMRG/trained_models/dmrg_L4_J2_0.5.pkl.gz ---
--- DMRG state loaded. ---

--- Generating 1024 samples from DMRG wavefunction ---
--- Sampling complete ---

--- Starting NetKet RBM Calculation ---
Automatic SR implementation choice:  QGT
  0%|          | 0/1 [00:00<?, ?it/s]2025-11-22 17:58:32.774901: E external/xla/xla/service/slow_operation_alarm.cc:73] 
********************************
[Compiling module jit__local_estimators_kernel] Very slow compile? If you want to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
********************************
2025-11-22 17:59:22.199448: E external/xla/xla/service/slow_operation_alarm.cc:140] The operation took 2m49.42621497s

********************************
[Compiling module jit__local_estimators_kernel] Very slow compile? If you want to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
********************************
  0%|          | 0/1 [13:33<?, ?it/s, Energy=11.9978-0.0014j ± 0.0039 [σ²=1.3e-02, R̂=1.013]]100%|██████████| 1/1 [00:15<00:00, 15.79s/it, Energy=11.9978-0.0014j ± 0.0039 [σ²=1.3e-02, R̂=1.013]]100%|██████████| 1/1 [00:15<00:00, 15.79s/it, Energy=11.9978-0.0014j ± 0.0039 [σ²=1.3e-02, R̂=1.013]]
Final RBM Energy: 11.997799
Final RBM Energy per site: 0.749862
--- NetKet RBM Calculation Finished ---

==================== Running for n_iter = 40 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter40_iter40.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.000019
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.000112

==================== Running for n_iter = 60 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter60_iter60.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.003106
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.008657

==================== Running for n_iter = 80 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter80_iter80.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.016908
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.035674

==================== Running for n_iter = 100 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter100_iter100.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.040707
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.068869

==================== Running for n_iter = 120 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter120_iter120.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.071600
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.102285

==================== Running for n_iter = 140 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter140_iter140.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.108528
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.135951

==================== Running for n_iter = 160 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter160_iter160.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.146618
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.166732

==================== Running for n_iter = 180 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter180_iter180.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.179862
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.192453

==================== Running for n_iter = 200 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter200_iter200.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.207753
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.216652

==================== Running for n_iter = 220 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter220_iter220.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.239373
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.242785

==================== Running for n_iter = 240 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter240_iter240.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.265420
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.265214

==================== Running for n_iter = 260 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter260_iter260.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.287261
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.286755

==================== Running for n_iter = 280 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter280_iter280.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.311078
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.316828

==================== Running for n_iter = 300 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter300_iter300.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.337440
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.340894

==================== Running for n_iter = 400 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter400_iter400.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.482245
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.487513

==================== Running for n_iter = 500 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter500_iter500.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.544088
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.542801

==================== Running for n_iter = 600 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter600_iter600.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.592284
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.595812

==================== Running for n_iter = 700 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter700_iter700.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.602417
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.609302

==================== Running for n_iter = 800 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter800_iter800.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.595737
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.603925

==================== Running for n_iter = 900 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter900_iter900.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.618605
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.620500

==================== Running for n_iter = 1000 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter1000_iter1000.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.619020
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.620168

==================== Running for n_iter = 2000 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter2000_iter2000.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.603918
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.603519

==================== Running for n_iter = 3000 ====================

--- Starting NetKet RBM Calculation ---
--- Loading pre-trained RBM parameters from DMRG/trained_models/rbm_L4_J2_0.5_iter3000_iter3000.mpack ---
--- RBM parameters loaded. ---
--- NetKet RBM Calculation Finished ---

Fidelity exact (RBM_Full vs DMRG_Full): 0.576409
Fidelity sampled (RBM_sampled vs DMRG_sampled): 0.574047

✅ Final fidelity plot saved to DMRG/plot/Fidelity_vs_Iterations/fidelity_vs_n_iter_L4_J2_0.5.png
