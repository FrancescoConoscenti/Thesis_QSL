Rank=0: Total number of GPUs: 1, devices: [CudaDevice(id=0)]
Rank=0: Local number of GPUs: 1, devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [03:39<?, ?it/s, Energy=-5.66+0.00j ± 0.30 [σ²=9.4e+01, R̂=1.225]]100%|██████████| 1/1 [00:00<00:00, 10.55it/s, Energy=-5.66+0.00j ± 0.30 [σ²=9.4e+01, R̂=1.225]]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [03:40<?, ?it/s, Energy=-8.23-0.00j ± 0.35 [σ²=1.2e+02, R̂=1.225]]100%|██████████| 1/1 [00:00<00:00, 1158.65it/s, Energy=-8.23-0.00j ± 0.35 [σ²=1.2e+02, R̂=1.225]]
/scratch/f/F.Conoscenti/Thesis_QSL/Elaborate/Plotting/Sign_vs_iteration.py:352: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.80, 1])  # leave room on the right for our insets
/scratch/f/F.Conoscenti/Thesis_QSL/HFDS_Heisenberg/run_spin.py:251: UserWarning: n_samples=256 (256 per JAX device) does not divide n_chains=512, increased to 512 (512 per JAX device)
  vstate.n_samples = 256
2025-11-11 15:51:34.592664: W external/xla/xla/tsl/framework/bfc_allocator.cc:310] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.17GiB with freed_by_count=0. The caller indicates that this is not a failure, but this may mean that there could be performance gains if more memory were available.
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/scratch/f/F.Conoscenti/Thesis_QSL/HFDS_Heisenberg/run_spin.py", line 252, in <module>
    S_matrices, eigenvalues = plot_S_matrix_eigenvalues(vstate, folder, hi,  one_avg = "one")
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/Thesis_QSL/Elaborate/Plotting/S_matrix_vs_iteration.py", line 20, in plot_S_matrix_eigenvalues
    S_matrix = compute_S_matrix(vstate, folder_path, hi)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/Thesis_QSL/Elaborate/S_matrix_Obs.py", line 23, in compute_S_matrix
    S_matrix = compute_S_matrix_single_model(vstate, hi)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/Thesis_QSL/Elaborate/S_matrix_Obs.py", line 31, in compute_S_matrix_single_model
    S_matrix = qgt.to_dense()
               ^^^^^^^^^^^^^^
  File "/scratch/f/F.Conoscenti/netket_venv1/lib/python3.11/site-packages/netket/optimizer/qgt/qgt_onthefly.py", line 224, in to_dense
    return _to_dense(self)
           ^^^^^^^^^^^^^^^
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1259339776 bytes.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
srun: error: th-cl-naples12: task 0: Exited with exit code 1
srun: Terminating StepId=10748213.0
